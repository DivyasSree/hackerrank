SELECT Z.HACKER_ID, H.NAME, SUM(Z.SCORE) AS TOT_SCORE
FROM (SELECT HACKER_ID, CHALLENGE_ID, MAX(SCORE) AS SCORE 
      FROM SUBMISSIONS
      GROUP BY HACKER_ID, CHALLENGE_ID) AS Z
      JOIN HACKERS H
      ON Z.HACKER_ID = H.HACKER_ID
      
GROUP BY Z.HACKER_ID, H.NAME
HAVING TOT_SCORE > 0
ORDER BY TOT_SCORE DESC, HACKER_ID
