-- Top Competitors
-- https://www.hackerrank.com/challenges/full-score/problem

SELECT H.HACKER_ID, H.NAME
FROM HACKERS H, SUBMISSIONS S, DIFFICULTY D, CHALLENGES C
WHERE H.HACKER_ID = S.HACKER_ID
AND D.DIFFICULTY_LEVEL = C.DIFFICULTY_LEVEL
AND C.CHALLENGE_ID = S.CHALLENGE_ID
AND D.SCORE = S.SCORE
GROUP BY H.HACKER_ID, H.NAME
HAVING COUNT(S.CHALLENGE_ID)>1
ORDER BY COUNT(S.CHALLENGE_ID) DESC, H.HACKER_ID ASC
